function Emdot = SecularRates(Em, mu, Re, Jcoeff)
% Computes secular rates of Delaunay elements (l,g,h,L,G,H) up to 1st order
% due to any zonal harmonic.

L = Em(4);
G = Em(5);
H = Em(6);

% classical elements
% a = L^2/mu;
% eta = G/L;
% e = sqrt(1 - eta^2);
% i = acos(H/G);

J(2:6) = Jcoeff(2:6);
R__e = Re;

% Secular rates using Maple for J2 to J6
Emdot(1,1) = mu^2/L^3 -0.2625e4 / 0.2048e4 * (G ^ 4 - 0.10e2 / 0.3e1 * G ^ 2 * L ^ 2 + 0.9e1 / 0.5e1 * L ^ 4) * mu ^ 8 * (G ^ 6 - 0.21e2 * G ^ 4 * H ^ 2 + 0.63e2 * G ^ 2 * H ^ 4 - 0.231e3 / 0.5e1 * H ^ 6) / L ^ 8 / G ^ 17 * J(6) * R__e ^ 6 + 0.135e3 / 0.128e3 * (G + L) * (G ^ 4 - 0.10e2 * H ^ 2 * G ^ 2 + 0.35e2 / 0.3e1 * H ^ 4) * mu ^ 6 * (G - L) / G ^ 11 / L ^ 6 * J(4) * R__e ^ 4 - 0.3e1 / 0.4e1 * J(2) * (G ^ 2 - 0.3e1 * H ^ 2) / L ^ 4 / G ^ 5 * R__e ^ 2 * mu ^ 4;

Emdot(2,1) = -0.2625e4 / 0.2048e4 * ((G ^ 10) + ((-27 * H ^ 2 - 6 * L ^ 2) * G ^ 8) + ((99 * H ^ 4) + (154 * H ^ 2 * L ^ 2) + 0.33e2 / 0.5e1 * (L ^ 4)) * (G ^ 6) + (-0.429e3 / 0.5e1 * (H ^ 6) - (546 * H ^ 4 * L ^ 2) - 0.819e3 / 0.5e1 * (H ^ 2) * (L ^ 4)) * (G ^ 4) + ((462 * H ^ 6 * L ^ 2 + 567 * H ^ 4 * L ^ 4) * G ^ 2) - 0.11781e5 / 0.25e2 * (H ^ 6) * (L ^ 4)) * mu ^ 8 / (L ^ 7) / (G ^ 18) * J(6) * R__e ^ 6 + 0.15e2 / 0.128e3 / (L ^ 5) * mu ^ 6 / (G ^ 12) * (9 * G ^ 6 - 126 * G ^ 4 * H ^ 2 - 21 * G ^ 4 * L ^ 2 + 189 * G ^ 2 * H ^ 4 + 270 * G ^ 2 * H ^ 2 * L ^ 2 - 385 * H ^ 4 * L ^ 2) * J(4) * R__e ^ 4 - 0.3e1 / 0.4e1 / (G ^ 6) / (L ^ 3) * (G ^ 2 - 5 * H ^ 2) * mu ^ 4 * J(2) * R__e ^ 2;

Emdot(3,1) = -0.105e3 / 0.1024e4 * H * (5 * G ^ 4 - 30 * H ^ 2 * G ^ 2 + 33 * H ^ 4) * (mu ^ 8) * (15 * G ^ 4 - 70 * G ^ 2 * L ^ 2 + 63 * L ^ 4) / (L ^ 7) / (G ^ 17) * J(6) * (R__e ^ 6) + 0.15e2 / 0.32e2 * H * (3 * G ^ 2 - 5 * L ^ 2) * (mu ^ 6) * (3 * G ^ 2 - 7 * H ^ 2) / (L ^ 5) / (G ^ 11) * J(4) * (R__e ^ 4) - 0.3e1 / 0.2e1 * J(2) * H / (L ^ 3) / (G ^ 5) * (R__e ^ 2) * (mu ^ 4);

Emdot(4:6,1) = 0;


%Should I comment those?
%!!!!!!!!!!!!

% 2nd order J3
ldotJ32 = 0;%-0.3e1 / 0.16e2 * (R__e ^ 4) * (mu ^ 6) * (J(3) ^ 2) * (10 * G ^ 6 - 90 * G ^ 4 * H ^ 2 - 9 * G ^ 4 * L ^ 2 + 100 * G ^ 2 * H ^ 4 + 72 * G ^ 2 * H ^ 2 * L ^ 2 - 75 * H ^ 4 * L ^ 2) / (G ^ 11) / (L ^ 6) / J(2);
gdotJ32 = 0;%-0.3e1 / 0.16e2 * (R__e ^ 4) * (mu ^ 6) * (J(3) ^ 2) * (10 * G ^ 6 - 126 * G ^ 4 * H ^ 2 - 21 * G ^ 4 * L ^ 2 + 180 * G ^ 2 * H ^ 4 + 216 * G ^ 2 * H ^ 2 * L ^ 2 - 275 * H ^ 4 * L ^ 2) / (G ^ 12) / (L ^ 5) / J(2);
hdotJ32 = 0;%-0.3e1 / 0.4e1 * (R__e ^ 4) * (mu ^ 6) * (J(3) ^ 2) * H * (9 * G ^ 4 - 20 * G ^ 2 * H ^ 2 - 12 * G ^ 2 * L ^ 2 + 25 * L ^ 2 * H ^ 2) / (G ^ 11) / (L ^ 5) / J(2);

Emdot(1:3,1) = Emdot(1:3,1) + 1/2*[ldotJ32; gdotJ32; hdotJ32];


end
